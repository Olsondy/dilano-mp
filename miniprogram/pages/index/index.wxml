<!--index.wxml-->
<view class="page-container">
  <navigation-bar title="é¦–é¡µ" back="{{false}}" color="black" background="#FFF"></navigation-bar>
  <view wx:if="{{loading}}" class="skeleton-screen">
    <view class="sk-header"></view>
    <view class="sk-body">
      <view class="sk-title"></view>
      <view class="sk-cards">
        <view class="sk-card-item" wx:for="{{2}}" wx:key="index"></view>
      </view>
      <view class="sk-title" style="width: 40%;"></view>
      <view class="sk-list" wx:for="{{3}}" wx:key="index">
        <view class="sk-time"></view>
        <view class="sk-content"></view>
      </view>
    </view>
  </view>

  <view wx:else class="actual-content">
    <view class="header-bg">
      <view class="company-name">DILANO çŸ³ä¸š</view>
      <view class="announcement">ğŸ“¢ å…¬å‘Šï¼š</view>
    </view>

    <view class="main-container">
      <view class="section">
        <view class="section-title">é¡¹ç›®æ¦‚è§ˆ</view>
        <swiper 
          class="projects-carousel project-swiper" 
          previous-margin="60rpx" 
          next-margin="60rpx" 
          bindchange="onSwiperChange"
          current="{{currentSwiperIndex}}"
        >
          <swiper-item wx:for="{{projectsData}}" wx:key="id">
            <view 
              class="summary-card {{currentSwiperIndex === index ? 'active' : ''}}" 
              style="--tag-color: {{item.tagColor}}"
            >
              <view class="card-tag">{{item.tagText}}</view>
              <view class="status-row">
                <text class="status-desc">{{item.statusDesc}}</text>
                <text class="status-label">çŠ¶æ€</text>
              </view>
              <view class="project-name">{{item.name}}</view>
              <view class="divider-line"></view>
              <view class="material-info">{{item.material}}</view>
              <view class="create-time">åˆ›å»ºäº: {{item.time}}</view>
            </view>
          </swiper-item>
        </swiper>
      </view>

      <view class="section detail-section">
        <view class="section-title">é¡¹ç›®è¯¦æƒ…</view>
        
        <view class="schedule-header">
          <view class="col-time">æ—¶é—´</view>
          <view class="col-progress">è¿›åº¦</view>
          <view class="col-icon">
            <view class="col-icon-btn" bindtap="toggleSort">
              <view class="sort-arrow {{isDescending ? '' : 'ascending'}}"></view>
            </view>
          </view>
        </view>
        
        <view class="timeline-container {{switchAnimation ? 'animate-switch' : ''}}">
          <view 
            wx:for="{{displayTimeline}}" 
            wx:key="ts" 
            class="timeline-row"
            style="animation-delay: {{index * 0.08}}s;"
          >
            <view class="time-cell">
              <view class="time-val">{{item.t}}</view>
              <view class="date-val">{{item.d}}</view>
            </view>
            <view class="progress-cell">
              <view class="detail-card">
                <view class="detail-header" style="background:{{activeThemeColor}}">
                  <text class="detail-title">{{item.title}}</text>
                  <text class="detail-status">{{item.status}}</text>
                </view>
                <view class="detail-body">{{item.info}}</view>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
